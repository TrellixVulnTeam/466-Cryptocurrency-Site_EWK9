{% extends 'coinbase.html' %}

{% block title %}Bitcoin (BTC){% endblock %}

<script>
{% block jquery%}
var endpoint = 'api/hourdata/'
var defaultData = []
var labels = [`low`, 'close', 'high'];
$.ajax({
    method: "GET",
    url: endpoint,
    data: 'BTC',
    success: function(result){
        defaultData = result
        createGraph()
    },
    error: function(err_data){
        console.log("error")
        console.log(err_data)
    }
})

function createGraph(){
    var close = [];
    var low = [];
    var high = [];
    var jsonData = JSON.parse(defaultData);
    var tempData = jsonData.data;
    var indices = jsonData.index;
    var size = Object.keys(tempData).length;
    for (var a = 0; a < size; a++) {
        close.push(tempData[a][0]);
        low.push(tempData[a][2]);
        high.push(tempData[a][1]);
    }
    var g1 = document.getElementById("BTCgraph");
    var graph = new Chart(g1, {
        type: 'line',
        data: {
            labels: indices,
            datasets: [
              {
                label: "close",
                data: close,
                fill: false,
                borderColor: 'rgba(0, 0, 0, 1)',
                lineTension: 0
              },
              {
                label: "low",
                data: low,
                fill: false,
                borderColor: 'rgba(255, 165, 0, 1)',
                lineTension: 0
              },
              {
                label: "high",
                data: high,
                fill: false,
                borderColor: 'rgba(0, 255, 0, 1)',
                lineTension: 0
              }
            ]
        }
    })
}
{% endblock %}
</script>

{% block graph %}
<canvas id="BTCgraph"></canvas>
{% endblock %}

{% block title2 %}Bitcoin{% endblock %}

{% block right %}
Maecenas finibus fermentum arcu vel molestie. Etiam non justo a magna posuere ornare.
{% endblock %}

{% block left%}
Nunc egestas tristique pulvinar. Vivamus aliquam euismod nibh vel efficitur. Maecenas finibus fermentum arcu vel molestie. Etiam non justo a magna posuere ornare. Praesent ac augue sit amet nisl vulputate pellentesque vel at tellus.
{% endblock %}
